<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#064e3b">
    <link rel="manifest" href="manifest.json">
    <title>Plant Vibe Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-[#f8faf8] p-4 md:p-8 font-['Plus_Jakarta_Sans']" x-data="plantApp()">

    <div class="max-w-4xl mx-auto">
        <div class="flex flex-col md:flex-row justify-between items-center mb-10 bg-white p-6 rounded-[2.5rem] shadow-sm border border-green-100 gap-4">
            <div>
                <h1 class="text-3xl font-extrabold text-green-900">Moje D≈æungle üåø</h1>
                <p class="text-green-600 text-sm font-medium" x-text="season === 'summer' ? 'Letn√≠ re≈æim ‚òÄÔ∏è' : 'Zimn√≠ re≈æim ‚ùÑÔ∏è'"></p>
            </div>
            
            <div class="flex items-center gap-4">
                <div class="flex bg-gray-100 p-1 rounded-2xl">
                    <button @click="setSeason('summer')" :class="season === 'summer' ? 'bg-white shadow-sm text-orange-500' : 'text-gray-400'" class="px-4 py-2 rounded-xl text-sm font-bold transition-all">L√©to</button>
                    <button @click="setSeason('winter')" :class="season === 'winter' ? 'bg-white shadow-sm text-blue-500' : 'text-gray-400'" class="px-4 py-2 rounded-xl text-sm font-bold transition-all">Zima</button>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-[2.5rem] p-8 shadow-sm border border-green-100 mb-10">
            <h3 class="text-sm font-bold text-gray-400 uppercase mb-4 tracking-widest text-center">Nov√° rostlina</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div>
                    <label class="text-[10px] font-black uppercase text-gray-400 ml-1">N√°zev / Druh</label>
                    <input x-model="newName" @input="checkLibrary()" type="text" placeholder="Zkus 'Monstera'..." class="w-full bg-gray-50 border-none rounded-2xl px-5 py-4 mt-1 focus:ring-2 focus:ring-green-500 outline-none">
                </div>
                <div>
                    <label class="text-[10px] font-black uppercase text-gray-400 ml-1">L√©to (dny)</label>
                    <input x-model="summerDays" type="number" class="w-full bg-gray-50 border-none rounded-2xl px-5 py-4 mt-1 text-orange-600 font-bold focus:ring-2 focus:ring-orange-400 outline-none">
                </div>
                <div>
                    <label class="text-[10px] font-black uppercase text-gray-400 ml-1">Zima (dny)</label>
                    <input x-model="winterDays" type="number" class="w-full bg-gray-50 border-none rounded-2xl px-5 py-4 mt-1 text-blue-600 font-bold focus:ring-2 focus:ring-blue-400 outline-none">
                </div>
                <div>
                    <label class="text-[10px] font-black uppercase text-gray-400 ml-1">Kdy byla zalit√°?</label>
                    <select x-model="lastWateredOffset" class="w-full bg-gray-50 border-none rounded-2xl px-5 py-4 mt-1 font-bold text-gray-700 focus:ring-2 focus:ring-green-500 outline-none appearance-none">
                        <option value="0">Dnes</option>
                        <option value="1">Vƒçera</option>
                        <option value="2">P≈ôed 2 dny</option>
                        <option value="3">P≈ôed 3 dny</option>
                        <option value="7">P≈ôed t√Ωdnem</option>
                        <option value="14">P≈ôed 2 t√Ωdny</option>
                    </select>
                </div>
            </div>
            <button @click="addPlant()" class="w-full mt-6 bg-green-900 text-white py-4 rounded-2xl font-bold hover:bg-black transition-all shadow-xl active:scale-[0.98]">
                P≈ôidat do sb√≠rky +
            </button>
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-8">
            <template x-for="plant in plants" :key="plant.id">
                <div class="bg-white rounded-[3rem] p-8 shadow-sm border border-green-50 relative transition-all duration-500" :class="plant.daysLeft <= 0 ? 'bg-red-50 border-red-100' : ''">
                    <button @click="confirmRemove(plant.id)" class="absolute top-8 right-8 text-gray-300 hover:text-red-500 transition-colors">‚úï</button>
                    
                    <div class="text-6xl mb-6 bg-gray-50 w-24 h-24 flex items-center justify-center rounded-[2rem]" x-text="plant.daysLeft <= 0 ? 'ü•Ä' : 'ü™¥'"></div>
                    
                    <h2 class="text-2xl font-black text-gray-900 mb-1" x-text="plant.name"></h2>
                    <p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-6">Posledn√≠: <span class="text-gray-600" x-text="plant.lastWatered"></span></p>
                    
                    <div class="space-y-4 mb-8">
                        <div class="flex justify-between items-end">
                            <div>
                                <span class="text-4xl font-black" :class="plant.daysLeft <= 0 ? 'text-red-600' : 'text-green-900'" x-text="plant.daysLeft"></span>
                                <span class="text-sm font-bold text-gray-400 uppercase">dn√≠</span>
                            </div>
                            <div class="text-right">
                                <span class="text-[10px] font-black text-gray-300 uppercase block">Pl√°n</span>
                                <span class="font-bold text-gray-500" x-text="(season === 'summer' ? plant.summerDays : plant.winterDays) + 'd'"></span>
                            </div>
                        </div>
                        <div class="w-full bg-gray-100 h-4 rounded-full overflow-hidden p-1">
                            <div class="h-full rounded-full transition-all duration-1000" 
                                 :class="plant.daysLeft <= 0 ? 'bg-red-500' : 'bg-green-500'"
                                 :style="`width: ${Math.max(0, (plant.daysLeft / (season === 'summer' ? plant.summerDays : plant.winterDays)) * 100)}%`"
                            ></div>
                        </div>
                    </div>

                    <button @click="waterPlant(plant.id)" class="w-full py-5 bg-green-600 text-white font-black rounded-2xl hover:bg-green-700 transition-all shadow-xl shadow-green-100 flex items-center justify-center gap-3 active:scale-95">
                        ZAL√çT TERAZ üíß
                    </button>
                </div>
            </template>
        </div>
    </div>

    <script>
        function plantApp() {
            return {
                plants: [],
                newName: '',
                summerDays: 7,
                winterDays: 14,
                lastWateredOffset: 0,
                season: 'summer',
                // KNIHOVNA ROSTLIN
                library: {
                    'monstera': { s: 7, w: 14 },
                    'fikus': { s: 5, w: 10 },
                    'lopatkovec': { s: 3, w: 7 },
                    'svokra': { s: 14, w: 30 },
                    'dracena': { s: 7, w: 14 },
                    'potosovec': { s: 5, w: 12 },
                    'aloa': { s: 14, w: 21 },
                    'orchidea': { s: 7, w: 10 }
                },

                init() {
                    const saved = localStorage.getItem('vibeJunglePro');
                    const savedSeason = localStorage.getItem('vibeJungleSeasonPro');
                    if (saved) this.plants = JSON.parse(saved);
                    if (savedSeason) this.season = savedSeason;
                    
                    this.$watch('plants', v => localStorage.setItem('vibeJunglePro', JSON.stringify(v)));
                    this.$watch('season', v => localStorage.setItem('vibeJungleSeasonPro', v));

                    setInterval(() => this.recalculateAll(), 60000); // Ka≈ædou minutu p≈ôepoƒç√≠tat
                },

                checkLibrary() {
                    const find = this.newName.toLowerCase().trim();
                    if (this.library[find]) {
                        this.summerDays = this.library[find].s;
                        this.winterDays = this.library[find].w;
                    }
                },

                addPlant() {
                    if (!this.newName) return;
                    
                    const now = new Date();
                    // Nastaven√≠ ƒçasu do minulosti podle v√Ωbƒõru u≈æivatele
                    const wateredAt = new Date(now.getTime() - (this.lastWateredOffset * 86400000));
                    
                    const maxDays = this.season === 'summer' ? this.summerDays : this.winterDays;
                    const daysLeft = Math.max(0, maxDays - this.lastWateredOffset);

                    this.plants.push({
                        id: Date.now(),
                        name: this.newName,
                        summerDays: parseInt(this.summerDays),
                        winterDays: parseInt(this.winterDays),
                        daysLeft: daysLeft,
                        lastWatered: wateredAt.toLocaleDateString('cs-CZ'),
                        lastWateredMs: wateredAt.getTime()
                    });

                    this.newName = '';
                    this.lastWateredOffset = 0;
                },

                waterPlant(id) {
                    const now = new Date();
                    let p = this.plants.find(p => p.id === id);
                    p.lastWatered = now.toLocaleDateString('cs-CZ');
                    p.lastWateredMs = now.getTime();
                    p.daysLeft = this.season === 'summer' ? p.summerDays : p.winterDays;
                },

                recalculateAll() {
                    const now = new Date().getTime();
                    const msInDay = 86400000;
                    this.plants.forEach(p => {
                        const maxDays = this.season === 'summer' ? p.summerDays : p.winterDays;
                        const daysElapsed = Math.floor((now - p.lastWateredMs) / msInDay);
                        p.daysLeft = Math.max(0, maxDays - daysElapsed);
                    });
                },

                setSeason(s) {
                    this.season = s;
                    this.recalculateAll();
                },

                confirmRemove(id) {
                    if (confirm('Opravdu chce≈° tuto rostlinu smazat?')) {
                        this.plants = this.plants.filter(p => p.id !== id);
                    }
                }
            }
        }
    </script>
</body>
</html>
